import{o as D,t as L,j as e,s as N,r,_ as $,v as E,w as F,A as H,C as o,h as P,S as A,H as p,d as y,T as R,N as T}from"./index-34628936.js";import{b as I}from"./index-836fb061.js";import{u as G,e as _,i as U,a as V}from"./utils-83cd76fa.js";import{f as W,u as q,M as J,a as K,b as Q,c as X,d as Y,e as Z}from"./chunk-4FCEGNGT-eca0baa9.js";import{u as v}from"./chunk-BBVTFCMB-66dd3b93.js";import{C as ee}from"./chunk-5MKCW436-556f32d7.js";import{B as S}from"./chunk-UVUR7MCU-b2dbaa10.js";import{B as M}from"./chunk-PULVB27S-74ef8337.js";import{S as se}from"./chunk-NEK3OOAM-b857783c.js";import{I as b}from"./chunk-QINAG4RG-b1bd8399.js";var O=D((l,c)=>{const{className:t,...x}=l,m=L("chakra-modal__footer",t),u={display:"flex",alignItems:"center",justifyContent:"flex-end",...W().footer};return e.jsx(N.footer,{ref:c,...x,__css:u,className:m})});O.displayName="ModalFooter";const te=r.lazy(()=>$(()=>import("./index-5f37b47c.js"),["assets/index-5f37b47c.js","assets/index-34628936.js","assets/index-a1d4600f.css","assets/utils-83cd76fa.js","assets/chunk-QINAG4RG-b1bd8399.js","assets/index-d8256e71.css"]));function me(){var w,C;const[l,c]=r.useState(!1),[t,x]=r.useState(null),[m,h]=v(!0),[u,f]=v(!1),j=G(),B=E(),[s,g]=r.useState(null),k=F(),d=q();r.useEffect(()=>{(async()=>{h.on();try{const{data:n}=await y.get(`https://api.silentclient.net/store/get_item?type=cases&id=${B.id}`);x(n.case)}catch(n){_(n,j),k("/cases")}finally{h.off()}})()},[]);const i=r.useContext(H),z=a=>{g(a),d.onOpen(),c(!1)};return m?e.jsx(o,{w:"full",p:5,children:e.jsx(P,{size:"xl",color:"white"})}):t?e.jsxs(e.Fragment,{children:[e.jsx(ee,{p:4,bgColor:"#131313",maxW:"container.sm",minH:"230px",h:"230px",borderRadius:"xl",overflow:"hidden",maxH:"230px",children:!l&&e.jsx(o,{children:e.jsxs(A,{alignItems:"center",direction:"column",spacing:1,children:[e.jsx(p,{size:"md",children:t.name}),e.jsx(I.LazyLoadImage,{width:"170px",height:"170px",src:`https://api.silentclient.net${t.preview}`})]})})||e.jsx(r.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(te,{result:s,handleDrop:z,item:t})})}),e.jsx(o,{children:e.jsxs(S,{isLoading:u,isDisabled:l,w:["full","200px"],mt:2,onClick:async()=>{var a;if(!i.props.account){window.location.href=`https://auth.silentclient.net/login?redirect_url=${window.location.href}`;return}f.on();try{const{data:n}=await y.post("https://api.silentclient.net/store/open_case",{id:t.id},{headers:{Authorization:`Bearer ${(a=i.props)==null?void 0:a.accessToken}`}});await i.updateUser(),g({...n.drop,alreadyOwned:n.alreadyOwned}),c(!0)}catch(n){_(n,j)}finally{f.off()}},colorScheme:"green",children:["Open case for"," ",((U((w=i.props)==null?void 0:w.account)?Math.round(t.price-t.price*(V((C=i.props)==null?void 0:C.account)?.2:.1)):t.price)/100).toFixed(2),"$"]})}),e.jsxs(M,{mt:5,children:[e.jsx(o,{children:e.jsx(p,{size:"md",children:"Case Content"})}),e.jsx(se,{mt:2,spacing:2,columns:[2,3,5],children:t.items.map(a=>e.jsx(M,{userSelect:"none",p:2,bgColor:"#131313",children:a.preview?e.jsxs(e.Fragment,{children:[e.jsx(o,{children:e.jsx(b,{width:"100px",height:"100px",src:a.preview?`https://api.silentclient.net${a.preview}`:""})}),e.jsx(R,{size:"sm",mt:2,children:a.name})]}):e.jsx(o,{h:"full",children:e.jsx(p,{children:a.name})})}))}),e.jsxs(J,{isOpen:d.isOpen,onClose:d.onClose,children:[e.jsx(K,{}),e.jsxs(Q,{bgColor:"#131313",children:[e.jsx(X,{children:s==null?void 0:s.name}),e.jsx(Y,{}),e.jsx(Z,{children:e.jsx(o,{w:"full",children:(s==null?void 0:s.preview)&&e.jsx(b,{w:"300px",h:"300px",src:`https://api.silentclient.net${s==null?void 0:s.preview}`})||e.jsx(o,{h:"300px",w:"300px",children:e.jsx(p,{textAlign:"center",w:"300px",children:s==null?void 0:s.name})})})}),e.jsx(O,{children:e.jsx(S,{onClick:d.onClose,w:"full",children:"Claim"})})]})]})]})]}):e.jsx(T,{to:"/cases"})}export{me as default};
